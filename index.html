<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì•ˆì „í•œ ë¬¼ë†€ì´ ìˆ˜ì¹™ ë°©íƒˆì¶œ</title>
    <style>
        /* --- CSS ìŠ¤íƒ€ì¼ ì‹œì‘ --- */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        :root {
            --primary-color: #007bff;
            --light-color: #f4f4f4;
            --dark-color: #333;
            --success-color: #28a745;
            --warning-color: #ffc107;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: var(--dark-color);
            color: white;
            overflow: hidden;
        }
        
        /* --- ì‹œì‘ í™”ë©´ ìŠ¤íƒ€ì¼ --- */
        #start-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 90%;
            max-width: 500px;
            padding: 40px;
            background-color: var(--light-color);
            color: var(--dark-color);
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        #start-screen h1 { color: var(--primary-color); margin-top: 0; }
        #start-screen p { font-size: 1.1em; margin-bottom: 20px; }
        #start-screen input { font-size: 1.2em; padding: 12px; width: 80%; margin-bottom: 20px; border: 2px solid #ccc; border-radius: 5px; text-align: center; }
        #start-screen button { font-size: 1.3em; padding: 12px 30px; cursor: pointer; border: none; border-radius: 5px; background-color: var(--primary-color); color: white; transition: background-color 0.3s; }
        #start-screen button:hover { background-color: #0056b3; }

        /* --- ê²Œì„ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ --- */
        #game-container {
            display: none;
            width: 95%;
            max-width: 900px;
            text-align: center;
        }
        
        /* â˜…â˜…â˜… íƒ€ì´ë¨¸ í‘œì‹œ ìŠ¤íƒ€ì¼ ì¶”ê°€ â˜…â˜…â˜… */
        #timer-display {
            font-size: 2em;
            font-weight: bold;
            color: var(--warning-color);
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        #game-container h1 { color: var(--warning-color); }
        #room { position: relative; width: 100%; margin-bottom: 20px; border: 2px solid white; border-radius: 8px; }
        #room img { width: 100%; display: block; border-radius: 8px; }
        .clickable-object { position: absolute; cursor: pointer; transition: background-color 0.3s, border 0.3s; /* border: 2px dashed yellow; */ }
        .clickable-object:hover { background-color: rgba(255, 255, 0, 0.3); }
        .clickable-object.solved { border: 3px solid var(--success-color); pointer-events: none; }

        /* --- ëª¨ë‹¬ ê³µí†µ ìŠ¤íƒ€ì¼ --- */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .modal-content { background-color: var(--light-color); color: var(--dark-color); padding: 30px; border-radius: 10px; width: 90%; max-width: 500px; text-align: center; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .modal-content h2 { margin-top: 0; color: var(--primary-color); }
        .modal-content input { font-size: 1.1em; padding: 10px; margin: 10px 0; width: 80%; text-align: center; }
        .modal-content button { font-size: 1.1em; padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; background-color: var(--primary-color); color: white; }
        .close-button { position: absolute; top: 10px; right: 20px; color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        
        /* --- ë©”ëª¨ë¦¬ ì¹´ë“œ ê²Œì„ ìŠ¤íƒ€ì¼ --- */
        #memory-game-board { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 280px; height: 210px; margin: 20px auto; perspective: 1000px; }
        .memory-card { width: 60px; height: 60px; position: relative; transform-style: preserve-3d; transition: transform 0.5s; cursor: pointer; }
        .memory-card.flip { transform: rotateY(180deg); }
        .memory-card.matched { cursor: default; opacity: 0.5; }
        .front-face, .back-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 5px; display: flex; justify-content: center; align-items: center; font-size: 30px; }
        .front-face { background: #a3daff; }
        .back-face { background: var(--primary-color); color: white; transform: rotateY(180deg); }
        /* --- CSS ìŠ¤íƒ€ì¼ ë --- */
    </style>
</head>
<body>
    <div id="start-screen">
        <h1>[ì•ˆì „êµìœ¡] ë¬¼ë†€ì´ êµì‹¤ íƒˆì¶œ</h1>
        <p>ì°¸ì—¬í•˜ëŠ” í•™ìƒì˜ ë°˜ê³¼ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        <input type="text" id="user-info-input" placeholder="ì˜ˆ: 3í•™ë…„ 2ë°˜ 5ë²ˆ">
        <button id="start-button">ê²Œì„ ì‹œì‘</button>
    </div>

    <div id="game-container">
        <!-- â˜…â˜…â˜… íƒ€ì´ë¨¸ í‘œì‹œ ì˜ì—­ ì¶”ê°€ â˜…â˜…â˜… -->
        <div id="timer-display">00:00</div>
        
        <h1>[ì•ˆì „êµìœ¡] ë¬¼ë†€ì´ êµì‹¤ì„ íƒˆì¶œí•˜ë¼!</h1>
        <p>êµì‹¤ì˜ ì—¬ëŸ¬ ì‚¬ë¬¼ì„ í„°ì¹˜í•˜ì—¬ ì•ˆì „ ìˆ˜ì¹™ì„ ë°°ìš°ê³ , 3ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ì•„ ë¬¸ì„ ì—´ê³  íƒˆì¶œí•˜ì„¸ìš”.</p>

        <div id="room">
            <img src="https://images.unsplash.com/photo-1577896851231-70ef18881754?q=80&w=2070&auto=format&fit=crop" alt="êµì‹¤ ì´ë¯¸ì§€">
            
            <div class="clickable-object" id="obj-monitor" data-modal="modal-monitor" style="top: 25%; left: 24%; width: 52%; height: 40%;"></div>
            <div class="clickable-object" id="obj-speaker" data-modal="modal-speaker" style="top: 3%; left: 3%; width: 10%; height: 18%;"></div>
            <div class="clickable-object" id="obj-pencil" data-modal="modal-pencil" style="top: 73%; left: 45%; width: 10%; height: 10%;"></div>
            <div class="clickable-object" id="obj-door" data-modal="modal-password" style="top: 15%; left: 81%; width: 18%; height: 75%;"></div>
        </div>
    </div>

    <!-- ëª¨ë‹¬ íŒì—…ì°½ë“¤... -->
    <div id="modal-speaker" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ìŠ¤í”¼ì»¤ì—ì„œ ì•ˆë‚´ë°©ì†¡ì´ ë‚˜ì˜¨ë‹¤.</h2><p>"ë¬¼ë†€ì´ ì „, ì¶©ë¶„í•œ ì¤€ë¹„ìš´ë™ì€ í•„ìˆ˜! ì‹¬ì¥ì—ì„œ ë¨¼ ê³³ë¶€í„° ì²œì²œíˆ~ ì¤€ë¹„ìš´ë™ì€ ìµœì†Œ ëª‡ ë¶„ ì´ìƒ í•´ì•¼ í• ê¹Œìš”?"</p><input type="text" id="answer-speaker" placeholder="ìˆ«ìë§Œ ì…ë ¥"><button class="submit-answer" data-puzzle="speaker">í™•ì¸</button></div></div>
    <div id="modal-pencil" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì±…ìƒ ìœ„ í•„í†µì— ìª½ì§€ê°€ ìˆë‹¤.</h2><p>"ë¬¼ì— ë¹ ì§„ ì‚¬ëŒì„ ë°œê²¬í–ˆì„ ë•Œ, ê°€ì¥ ë¨¼ì € í•  ì¼ì€ í° ì†Œë¦¬ë¡œ ì£¼ë³€ì— ì•Œë¦¬ê³  OOOì— ì‹ ê³ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. OOOì— ë“¤ì–´ê°ˆ ë²ˆí˜¸ëŠ”?"</p><input type="text" id="answer-pencil" placeholder="ìˆ«ìë§Œ ì…ë ¥"><button class="submit-answer" data-puzzle="pencil">í™•ì¸</button></div></div>
    <div id="modal-monitor" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì¹ íŒì— ë¬´ì–¸ê°€ ë‚˜íƒ€ë‚¬ë‹¤!</h2><p>ì•ˆì „ ìˆ˜ì¹™ ì•„ì´ì½˜ì„ ê¸°ì–µí•´ì„œ ì§ì„ ë§ì¶°ë³´ì„¸ìš”!</p><div id="memory-game-board"></div><p id="memory-game-message"></p></div></div>
    <div id="modal-password" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>êµì‹¤ ë¬¸</h2><p>3ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  íƒˆì¶œí•˜ì„¸ìš”.</p><input type="text" id="passcode-input" placeholder="ë¹„ë°€ë²ˆí˜¸ 3ìë¦¬" maxlength="3" pattern="\d*"><button id="escape-button">íƒˆì¶œ</button></div></div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- ì‹œì‘ í™”ë©´ ë¡œì§ ---
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const userInfoInput = document.getElementById('user-info-input');
        const gameContainer = document.getElementById('game-container');
        
        // â˜…â˜…â˜… íƒ€ì´ë¨¸ ê´€ë ¨ ë³€ìˆ˜ ì¶”ê°€ â˜…â˜…â˜…
        const timerDisplay = document.getElementById('timer-display');
        let timerInterval;
        let startTime;

        startButton.addEventListener('click', () => {
            const userInfo = userInfoInput.value.trim();
            if (userInfo === '') {
                alert('ë°˜ê³¼ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            console.log(`ì°¸ê°€ì: ${userInfo}`);
            startScreen.style.display = 'none';
            gameContainer.style.display = 'block';
            
            // â˜…â˜…â˜… íƒ€ì´ë¨¸ ì‹œì‘ í•¨ìˆ˜ í˜¸ì¶œ â˜…â˜…â˜…
            startTimer();
        });

        // â˜…â˜…â˜… íƒ€ì´ë¨¸ ì‹œì‘ í•¨ìˆ˜ â˜…â˜…â˜…
        function startTimer() {
            startTime = Date.now(); // ì‹œì‘ ì‹œê°„ ê¸°ë¡
            timerInterval = setInterval(updateTimer, 1000); // 1ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
        }
        
        // â˜…â˜…â˜… íƒ€ì´ë¨¸ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ â˜…â˜…â˜…
        function updateTimer() {
            const elapsedTime = Date.now() - startTime;
            const totalSeconds = Math.floor(elapsedTime / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;

            // MM:SS í˜•ì‹ìœ¼ë¡œ í¬ë§·íŒ… (ì˜ˆ: 01:05)
            timerDisplay.textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }


        // --- ê¸°ì¡´ ê²Œì„ ë¡œì§ ---
        const FINAL_PASSCODE = '220'; 
        const PUZZLES = {
            speaker: { answer: '10', hint: '0', solved: false },
            pencil: { answer: '119', hint: '2', solved: false },
            monitor: { hint: '2', solved: false }
        };

        const clickableObjects = document.querySelectorAll('.clickable-object');
        const modals = document.querySelectorAll('.modal');
        const closeButtons = document.querySelectorAll('.close-button');

        clickableObjects.forEach(obj => {
            obj.addEventListener('click', () => {
                const modalId = obj.dataset.modal;
                if (modalId) document.getElementById(modalId).classList.add('active');
            });
        });

        closeButtons.forEach(btn => {
            btn.addEventListener('click', (e) => e.target.closest('.modal').classList.remove('active'));
        });
        
        window.addEventListener('click', (e) => {
            modals.forEach(modal => {
                if (e.target === modal) modal.classList.remove('active');
            });
        });

        document.querySelectorAll('.submit-answer').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const puzzleId = e.target.dataset.puzzle;
                const userAnswer = document.getElementById(`answer-${puzzleId}`).value.trim();
                
                if (userAnswer === PUZZLES[puzzleId].answer) {
                    let hintNumber;
                    if (puzzleId === 'speaker') {
                        hintNumber = userAnswer[1];
                        alert(`ì •ë‹µì…ë‹ˆë‹¤! ë‘ ë²ˆì§¸ ìˆ«ìë¥¼ ê¸°ì–µí•˜ì„¸ìš”. ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìˆ«ìëŠ” [${hintNumber}] ì…ë‹ˆë‹¤.`);
                    } else if (puzzleId === 'pencil') {
                        hintNumber = PUZZLES[puzzleId].hint;
                        alert(`ì •ë‹µ! 119ëŠ” ì¤‘ìš”í•´ìš”! íŒíŠ¸ë¥¼ ì–»ê¸° ìœ„í•´ 1+1ì„ í•´ë³´ì„¸ìš”. ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìˆ«ìëŠ” [${hintNumber}] ì…ë‹ˆë‹¤.`);
                    }
                    markAsSolved(puzzleId);
                    e.target.closest('.modal').classList.remove('active');
                } else {
                    alert('í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”!');
                }
            });
        });
        
        function markAsSolved(puzzleId) {
            PUZZLES[puzzleId].solved = true;
            document.getElementById(`obj-${puzzleId}`).classList.add('solved');
        }

        const gameBoard = document.getElementById('memory-game-board');
        const gameMessage = document.getElementById('memory-game-message');
        const cardEmojis = ['ğŸŠ', ' lifeguards', 'íŠœë¸Œ', 'ğŸš«', 'ğŸŠ', ' lifeguards', 'íŠœë¸Œ', 'ğŸš«'];
        let hasFlippedCard, lockBoard, firstCard, secondCard;
        let matchedPairs = 0;

        function createBoard() {
            gameBoard.innerHTML = '';
            matchedPairs = 0;
            shuffle(cardEmojis);
            cardEmojis.forEach(emoji => {
                const card = document.createElement('div');
                card.classList.add('memory-card');
                card.dataset.emoji = emoji;
                card.innerHTML = `<div class="front-face">?</div><div class="back-face">${emoji}</div>`;
                gameBoard.appendChild(card);
                card.addEventListener('click', flipCard);
            });
        }

        function shuffle(array) { array.sort(() => Math.random() - 0.5); }
        function flipCard() { if (lockBoard || this === firstCard || this.classList.contains('matched')) return; this.classList.add('flip'); if (!hasFlippedCard) { hasFlippedCard = true; firstCard = this; return; } secondCard = this; checkForMatch(); }
        function checkForMatch() { lockBoard = true; (firstCard.dataset.emoji === secondCard.dataset.emoji) ? disableCards() : unflipCards(); }
        function disableCards() { firstCard.classList.add('matched'); secondCard.classList.add('matched'); matchedPairs++; resetBoard(); if (matchedPairs === cardEmojis.length / 2) { gameMessage.textContent = `ì„±ê³µ! ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìˆ«ìëŠ” [${PUZZLES.monitor.hint}] ì…ë‹ˆë‹¤.`; setTimeout(() => { markAsSolved('monitor'); document.getElementById('modal-monitor').classList.remove('active'); }, 1500); } }
        function unflipCards() { setTimeout(() => { firstCard.classList.remove('flip'); secondCard.classList.remove('flip'); resetBoard(); }, 1000); }
        function resetBoard() { [hasFlippedCard, lockBoard] = [false, false]; [firstCard, secondCard] = [null, null]; }

        document.getElementById('obj-monitor').addEventListener('click', () => {
            if (!PUZZLES.monitor.solved) {
                gameMessage.textContent = '';
                createBoard();
            }
        });
        
        document.getElementById('escape-button').addEventListener('click', () => {
            const userInput = document.getElementById('passcode-input').value;
            if (userInput === FINAL_PASSCODE) {
                const allSolved = Object.values(PUZZLES).every(p => p.solved);
                if (allSolved) {
                    // â˜…â˜…â˜… íƒ€ì´ë¨¸ ì •ì§€ ë° ìµœì¢… ì‹œê°„ í‘œì‹œ â˜…â˜…â˜…
                    clearInterval(timerInterval); // íƒ€ì´ë¨¸ ë©ˆì¶¤
                    const finalTime = timerDisplay.textContent; // ìµœì¢… ì‹œê°„ ê¸°ë¡
                    alert(`ì •ë‹µì…ë‹ˆë‹¤! ì¶•í•˜í•©ë‹ˆë‹¤, ì•ˆì „ ìˆ˜ì¹™ì„ ëª¨ë‘ ë°°ìš°ê³  ë¬´ì‚¬íˆ íƒˆì¶œí–ˆìŠµë‹ˆë‹¤!\n\nì´ ì†Œìš” ì‹œê°„: ${finalTime}`);
                    location.reload();
                } else {
                    alert('ì•„ì§ êµì‹¤ì— í’€ì§€ ì•Šì€ ë¬¸ì œê°€ ë‚¨ì•„ìˆëŠ” ê²ƒ ê°™ì•„ìš”!');
                }
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. íŒíŠ¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ì„¸ìš”.');
            }
        });
    });
    </script>
</body>
</html>