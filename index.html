<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì•ˆì „í•œ ë¬¼ë†€ì´ ìˆ˜ì¹™ ë°©íƒˆì¶œ (í†µí•©ë³¸)</title>
    <style>
        /* --- CSS ìŠ¤íƒ€ì¼ ì‹œì‘ --- */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        :root {
            --primary-color: #007bff;
            --light-color: #f4f4f4;
            --dark-color: #333;
            --success-color: #28a745;
            --warning-color: #ffc107;
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: var(--dark-color);
            color: white;
            overflow: hidden;
        }
        
        /* --- ì‹œì‘ í™”ë©´ ìŠ¤íƒ€ì¼ --- */
        #start-screen {
            display: flex; /* ê¸°ë³¸ìœ¼ë¡œ ë³´ì„ */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 90%;
            max-width: 500px;
            padding: 40px;
            background-color: var(--light-color);
            color: var(--dark-color);
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
        }

        #start-screen h1 { color: var(--primary-color); margin-top: 0; }
        #start-screen p { font-size: 1.1em; margin-bottom: 20px; }
        #start-screen input { font-size: 1.2em; padding: 12px; width: 80%; margin-bottom: 20px; border: 2px solid #ccc; border-radius: 5px; text-align: center; }
        #start-screen button { font-size: 1.3em; padding: 12px 30px; cursor: pointer; border: none; border-radius: 5px; background-color: var(--primary-color); color: white; transition: background-color 0.3s; }
        #start-screen button:hover { background-color: #0056b3; }

        /* --- ê²Œì„ ì»¨í…Œì´ë„ˆ ê³µí†µ ìŠ¤íƒ€ì¼ --- */
        .game-stage {
            display: none; /* ëª¨ë“  ìŠ¤í…Œì´ì§€ëŠ” ì‹œì‘ ì‹œ ìˆ¨ê¹€ */
            width: 95%;
            max-width: 900px;
            text-align: center;
        }
        
        #timer-display {
            font-size: 2em;
            font-weight: bold;
            color: var(--warning-color);
            margin-bottom: 15px;
            letter-spacing: 2px;
        }

        .game-stage h1 { color: var(--warning-color); }
        .room { position: relative; width: 100%; margin-bottom: 20px; border: 2px solid white; border-radius: 8px; }
        .room img { width: 100%; display: block; border-radius: 8px; }
        .clickable-object { position: absolute; cursor: pointer; transition: background-color 0.3s, border 0.3s; }
        .clickable-object:hover { background-color: rgba(255, 255, 0, 0.4); border-radius: 8px; }
        .clickable-object.solved { border: 3px solid var(--success-color); pointer-events: none; background-color: rgba(40, 167, 69, 0.3); border-radius: 8px; }

        /* --- ëª¨ë‹¬ ê³µí†µ ìŠ¤íƒ€ì¼ --- */
        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); justify-content: center; align-items: center; }
        .modal.active { display: flex; }
        .modal-content { background-color: var(--light-color); color: var(--dark-color); padding: 30px; border-radius: 10px; width: 90%; max-width: 500px; text-align: center; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.3); animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .modal-content h2 { margin-top: 0; color: var(--primary-color); }
        .modal-content input { font-size: 1.1em; padding: 10px; margin: 10px 0; width: 80%; text-align: center; border: 2px solid #ccc; border-radius: 5px;}
        .modal-content button { font-size: 1.1em; padding: 10px 20px; cursor: pointer; border: none; border-radius: 5px; background-color: var(--primary-color); color: white; transition: background-color 0.3s; }
         .modal-content button:hover { background-color: #0056b3; }
        .close-button { position: absolute; top: 10px; right: 20px; color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        
        /* --- ë©”ëª¨ë¦¬ ì¹´ë“œ ê²Œì„ ìŠ¤íƒ€ì¼ --- */
        #s1-memory-game-board { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; width: 280px; height: 210px; margin: 20px auto; perspective: 1000px; }
        .memory-card { width: 60px; height: 60px; position: relative; transform-style: preserve-3d; transition: transform 0.5s; cursor: pointer; }
        .memory-card.flip { transform: rotateY(180deg); }
        .memory-card.matched { cursor: default; opacity: 0.5; }
        .front-face, .back-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 5px; display: flex; justify-content: center; align-items: center; font-size: 30px; }
        .front-face { background: #a3daff; }
        .back-face { background: var(--primary-color); color: white; transform: rotateY(180deg); }
        /* --- CSS ìŠ¤íƒ€ì¼ ë --- */
    </style>
</head>
<body>
    <!-- ======================= ì‹œì‘ í™”ë©´ ======================= -->
    <div id="start-screen">
        <h1>[ì•ˆì „êµìœ¡] ë¬¼ë†€ì´ êµì‹¤ íƒˆì¶œ</h1>
        <p>ì°¸ì—¬í•˜ëŠ” í•™ìƒì˜ ë°˜ê³¼ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
        <input type="text" id="user-info-input" placeholder="ì˜ˆ: 3í•™ë…„ 2ë°˜ 5ë²ˆ">
        <button id="start-button">ê²Œì„ ì‹œì‘</button>
    </div>

    <div id="timer-display" style="display:none; position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 50;">00:00</div>

    <!-- ======================= 1ë‹¨ê³„ ê²Œì„ ì»¨í…Œì´ë„ˆ ======================= -->
    <div id="stage-1-container" class="game-stage">
        <h1>[1ë‹¨ê³„] ë¬¼ë†€ì´ êµì‹¤ì„ íƒˆì¶œí•˜ë¼!</h1>
        <p>êµì‹¤ì˜ ì—¬ëŸ¬ ì‚¬ë¬¼ì„ í„°ì¹˜í•˜ì—¬ ì•ˆì „ ìˆ˜ì¹™ì„ ë°°ìš°ê³ , 3ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ì•„ ë¬¸ì„ ì—´ê³  íƒˆì¶œí•˜ì„¸ìš”.</p>
        <div class="room">
            <img src="https://github.com/lee-jun-seoung/text-page6/blob/main/Whisk_storyboard67da2e89d25144d4bb9ce11a%20(1).png?raw=true" alt="êµì‹¤ ì´ë¯¸ì§€">
            <div class="clickable-object" id="s1-obj-monitor" data-modal="s1-modal-monitor" style="top: 42%; left: 17%; width: 16%; height: 25%;"></div>
            <div class="clickable-object" id="s1-obj-speaker" data-modal="s1-modal-speaker" style="top: 14%; left: 78%; width: 12%; height: 12%;"></div>
            <div class="clickable-object" id="s1-obj-pencil" data-modal="s1-modal-pencil" style="top: 63%; left: 68%; width: 7%; height: 16%;"></div>
            <div class="clickable-object" id="s1-obj-door" data-modal="s1-modal-password" style="top: 24%; left: 91%; width: 9%; height: 60%;"></div>
        </div>
        <!-- 1ë‹¨ê³„ ëª¨ë‹¬ -->
        <div id="s1-modal-speaker" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ìŠ¤í”¼ì»¤ì—ì„œ ì•ˆë‚´ë°©ì†¡ì´ ë‚˜ì˜¨ë‹¤.</h2><p>"ë¬¼ë†€ì´ ì „, ì¶©ë¶„í•œ ì¤€ë¹„ìš´ë™ì€ í•„ìˆ˜! ì‹¬ì¥ì—ì„œ ë¨¼ ê³³ë¶€í„° ì²œì²œíˆ~ ì¤€ë¹„ìš´ë™ì€ ìµœì†Œ ëª‡ ë¶„ ì´ìƒ í•´ì•¼ í• ê¹Œìš”?"</p><input type="text" id="s1-answer-speaker" placeholder="ìˆ«ìë§Œ ì…ë ¥"><button class="submit-answer" data-puzzle="speaker" data-stage="1">í™•ì¸</button></div></div>
        <div id="s1-modal-pencil" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì±…ìƒ ìœ„ í•„í†µì— ìª½ì§€ê°€ ìˆë‹¤.</h2><p>"ë¬¼ì— ë¹ ì§„ ì‚¬ëŒì„ ë°œê²¬í–ˆì„ ë•Œ, ê°€ì¥ ë¨¼ì € í•  ì¼ì€ í° ì†Œë¦¬ë¡œ ì£¼ë³€ì— ì•Œë¦¬ê³  OOOì— ì‹ ê³ í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. OOOì— ë“¤ì–´ê°ˆ ë²ˆí˜¸ëŠ”?"</p><input type="text" id="s1-answer-pencil" placeholder="ìˆ«ìë§Œ ì…ë ¥"><button class="submit-answer" data-puzzle="pencil" data-stage="1">í™•ì¸</button></div></div>
        <div id="s1-modal-monitor" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ëª¨ë‹ˆí„° ì „ì›ì´ ì¼œì¡Œë‹¤!</h2><p id="s1-memory-game-message">ì•ˆì „ ìˆ˜ì¹™ ì•„ì´ì½˜ì„ ê¸°ì–µí•´ì„œ ì§ì„ ë§ì¶°ë³´ì„¸ìš”!</p><div id="s1-memory-game-board"></div></div></div>
        <div id="s1-modal-password" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>êµì‹¤ ë¬¸</h2><p>3ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  íƒˆì¶œí•˜ì„¸ìš”.</p><input type="text" id="s1-passcode-input" placeholder="ë¹„ë°€ë²ˆí˜¸ 3ìë¦¬" maxlength="3" pattern="\d*"><button id="s1-escape-button">íƒˆì¶œ</button></div></div>
    </div>

    <!-- ======================= 2ë‹¨ê³„ ê²Œì„ ì»¨í…Œì´ë„ˆ ======================= -->
    <div id="stage-2-container" class="game-stage">
        <h1>[2ë‹¨ê³„] ë³µë„ë¥¼ ì§€ë‚˜ íƒˆì¶œí•˜ë¼!</h1>
        <p>ë³µë„ì— ìˆëŠ” ì‚¬ë¬¼ë“¤ì„ í„°ì¹˜í•˜ì—¬ ì•ˆì „ ìˆ˜ì¹™ì„ ë°°ìš°ê³ , 3ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì°¾ì•„ ë¬¸ì„ ì—´ê³  íƒˆì¶œí•˜ì„¸ìš”.</p>
        <div class="room">
            <img src="https://github.com/lee-jun-seoung/text-page6/blob/main/Whisk_storyboard348adbde128e405cb6a037b4.png?raw=true" alt="ë³µë„ ì´ë¯¸ì§€">
            <div class="clickable-object" id="s2-obj-speaker" data-modal="s2-modal-speaker" style="top: 10%; left: 7%; width: 12%; height: 20%;"></div>
            <div class="clickable-object" id="s2-obj-window" data-modal="s2-modal-window" style="top: 25%; left: 30%; width: 45%; height: 40%;"></div>
            <div class="clickable-object" id="s2-obj-logo" data-modal="s2-modal-logo" style="top: 10%; left: 88%; width: 10%; height: 18%;"></div>
            <div class="clickable-object" id="s2-obj-door" data-modal="s2-modal-password" style="top: 25%; left: 63%; width: 14%; height: 60%;"></div>
        </div>
        <!-- 2ë‹¨ê³„ ëª¨ë‹¬ -->
        <div id="s2-modal-speaker" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ìŠ¤í”¼ì»¤ì—ì„œ ì•ˆë‚´ë°©ì†¡ì´ ë‚˜ì˜¨ë‹¤.</h2><p>ë¬¼ë†€ì´ ì¤‘ì—ëŠ” ê»Œì´ë‚˜ ì‚¬íƒ•ì„ ë¨¹ì§€ ì•ŠìŠµë‹ˆë‹¤. ë˜í•œ, ë¬¼ë†€ì´ëŠ” 50ë¶„ ì¦ê¸°ê³  Oë¶„ íœ´ì‹í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. Oì— ë“¤ì–´ê°ˆ ìˆ«ìëŠ” ë¬´ì—‡ì¼ê¹Œìš”?</p><input type="text" id="s2-answer-speaker" placeholder="ìˆ«ìë§Œ ì…ë ¥"><button class="submit-answer" data-puzzle="speaker" data-stage="2">í™•ì¸</button></div></div>
        <div id="s2-modal-window" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ì°½ë¬¸ì— ê¸€ìê°€ ì í˜€ìˆë‹¤.</h2><p>ê³„ê³¡ì´ë‚˜ ê°•ê°€ì—ì„œ ë¬¼ë†€ì´ë¥¼ í•  ë•Œ, ê°‘ìê¸° ë¹„ê°€ ì˜¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œìš”? ìœ„í—˜í•˜ë¯€ë¡œ ì¦‰ì‹œ ë¬¼ë†€ì´ë¥¼ OOOO, ì•ˆì „í•œ ê³³ìœ¼ë¡œ ëŒ€í”¼í•´ì•¼ í•©ë‹ˆë‹¤. OOOOì— ë“¤ì–´ê°ˆ ì•Œë§ì€ ë§ì€? (íŒíŠ¸: ã…ˆã„·)</p><input type="text" id="s2-answer-window" placeholder="ì •ë‹µ ì…ë ¥"><button class="submit-answer" data-puzzle="window" data-stage="2">í™•ì¸</button></div></div>
        <div id="s2-modal-logo" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ìƒˆ ëª¨ì–‘ì˜ ë¡œê³  ì•„ë˜ì— ê¸€ì´ ìˆë‹¤.</h2><p>ë¬¼ì— ë¹ ì§„ ì‚¬ëŒì„ ë°œê²¬í–ˆì„ ë•Œ, ë¬´í„±ëŒ€ê³  ë¬¼ì— ë›°ì–´ë“¤ë©´ ìœ„í—˜í•©ë‹ˆë‹¤. ì£¼ë³€ì— í° ì†Œë¦¬ë¡œ ì•Œë¦¬ê³  ì¦‰ì‹œ OOOì— ì‹ ê³ í•´ì•¼ í•©ë‹ˆë‹¤. OOOì— ë“¤ì–´ê°ˆ ë²ˆí˜¸ëŠ”?</p><input type="text" id="s2-answer-logo" placeholder="ìˆ«ìë§Œ ì…ë ¥"><button class="submit-answer" data-puzzle="logo" data-stage="2">í™•ì¸</button></div></div>
        <div id="s2-modal-password" class="modal"><div class="modal-content"><span class="close-button">Ã—</span><h2>ë³µë„ ë ë¬¸</h2><p>3ìë¦¬ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  íƒˆì¶œí•˜ì„¸ìš”.</p><input type="text" id="s2-passcode-input" placeholder="ë¹„ë°€ë²ˆí˜¸ 3ìë¦¬" maxlength="3" pattern="\d*"><button id="s2-escape-button">íƒˆì¶œ</button></div></div>
    </div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {

        // --- ê³µí†µ ë³€ìˆ˜ ë° ìš”ì†Œ ---
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const userInfoInput = document.getElementById('user-info-input');
        const timerDisplay = document.getElementById('timer-display');

        const stage1Container = document.getElementById('stage-1-container');
        const stage2Container = document.getElementById('stage-2-container');

        let timerInterval;
        let startTime;

        // --- ìŠ¤í…Œì´ì§€ë³„ í¼ì¦ ë°ì´í„° ---
        const STAGE_DATA = {
            1: {
                passcode: '220',
                puzzles: {
                    speaker: { answer: '10', hint: '0', solved: false },
                    pencil: { answer: '119', hint: '2', solved: false },
                    monitor: { hint: '2', solved: false }
                }
            },
            2: {
                passcode: '149',
                puzzles: {
                    speaker: { answer: '10', hint: '1', solved: false },
                    window: { answer: 'ì¤‘ë‹¨', hint: '4', solved: false },
                    logo: { answer: '119', hint: '9', solved: false }
                }
            }
        };

        // --- íƒ€ì´ë¨¸ ê¸°ëŠ¥ ---
        function startTimer() {
            startTime = Date.now();
            timerInterval = setInterval(updateTimer, 1000);
            timerDisplay.style.display = 'block';
        }
        
        function updateTimer() {
            const totalSeconds = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // --- ê²Œì„ ì‹œì‘ ---
        startButton.addEventListener('click', () => {
            if (userInfoInput.value.trim() === '') {
                alert('ë°˜ê³¼ ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            startScreen.style.display = 'none';
            stage1Container.style.display = 'block';
            startTimer();
        });
        
        // --- ê³µí†µ ëª¨ë‹¬ ë° ì˜¤ë¸Œì íŠ¸ ì´ë²¤íŠ¸ ì²˜ë¦¬ ---
        document.querySelectorAll('.clickable-object').forEach(obj => {
            obj.addEventListener('click', () => {
                const modalId = obj.dataset.modal;
                if (modalId) {
                    const modal = document.getElementById(modalId);
                    modal.classList.add('active');
                    // 1ë‹¨ê³„ ëª¨ë‹ˆí„° í´ë¦­ ì‹œ ë©”ëª¨ë¦¬ ê²Œì„ ìƒì„±
                    if (modalId === 's1-modal-monitor' && !STAGE_DATA[1].puzzles.monitor.solved) {
                         setupMemoryGame();
                    }
                }
            });
        });

        document.querySelectorAll('.close-button').forEach(btn => {
            btn.addEventListener('click', (e) => e.target.closest('.modal').classList.remove('active'));
        });

        document.querySelectorAll('.submit-answer').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const stage = e.target.dataset.stage;
                const puzzleId = e.target.dataset.puzzle;
                const userAnswer = document.getElementById(`s${stage}-answer-${puzzleId}`).value.trim();
                const puzzleData = STAGE_DATA[stage].puzzles[puzzleId];

                if (userAnswer === puzzleData.answer) {
                    let hintMessage = '';
                    if (stage === '1' && puzzleId === 'speaker') {
                        hintMessage = `ì •ë‹µì…ë‹ˆë‹¤! ë‘ ë²ˆì§¸ ìˆ«ìë¥¼ ê¸°ì–µí•˜ì„¸ìš”. ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìˆ«ìëŠ” [${userAnswer[1]}] ì…ë‹ˆë‹¤.`;
                    } else if (stage === '1' && puzzleId === 'pencil') {
                         hintMessage = `ì •ë‹µ! 119ëŠ” ì¤‘ìš”í•´ìš”! íŒíŠ¸ë¥¼ ì–»ê¸° ìœ„í•´ 1+1ì„ í•´ë³´ì„¸ìš”. ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìˆ«ìëŠ” [${puzzleData.hint}] ì…ë‹ˆë‹¤.`;
                    } else {
                        hintMessage = `ì •ë‹µì…ë‹ˆë‹¤! ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìˆ«ìëŠ” [${puzzleData.hint}] ì…ë‹ˆë‹¤.`;
                    }
                    alert(hintMessage);
                    markAsSolved(stage, puzzleId);
                    e.target.closest('.modal').classList.remove('active');
                } else {
                    alert('í‹€ë ¸ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ìƒê°í•´ë³´ì„¸ìš”!');
                }
            });
        });

        function markAsSolved(stage, puzzleId) {
            STAGE_DATA[stage].puzzles[puzzleId].solved = true;
            document.getElementById(`s${stage}-obj-${puzzleId}`).classList.add('solved');
        }

        // --- 1ë‹¨ê³„ ë¡œì§ ---
        const s1_gameBoard = document.getElementById('s1-memory-game-board');
        const s1_gameMessage = document.getElementById('s1-memory-game-message');
        const cardEmojis = ['ğŸŠ', ' lifeguards', 'íŠœë¸Œ', 'ğŸš«', 'ğŸŠ', ' lifeguards', 'íŠœë¸Œ', 'ğŸš«'];
        let hasFlippedCard, lockBoard, firstCard, secondCard;
        let matchedPairs = 0;

        function setupMemoryGame() {
            s1_gameMessage.innerHTML = `ì•ˆì „ ìˆ˜ì¹™ ì•„ì´ì½˜ì„ ê¸°ì–µí•´ì„œ ì§ì„ ë§ì¶°ë³´ì„¸ìš”!`;
            s1_gameBoard.innerHTML = '';
            matchedPairs = 0;
            hasFlippedCard = false;
            lockBoard = false;
            shuffle(cardEmojis);
            cardEmojis.forEach(emoji => {
                const card = document.createElement('div');
                card.classList.add('memory-card');
                card.dataset.emoji = emoji;
                card.innerHTML = `<div class="front-face">?</div><div class="back-face">${emoji}</div>`;
                s1_gameBoard.appendChild(card);
                card.addEventListener('click', flipCard);
            });
        }

        function shuffle(array) { array.sort(() => Math.random() - 0.5); }
        function flipCard() { if (lockBoard || this === firstCard || this.classList.contains('matched')) return; this.classList.add('flip'); if (!hasFlippedCard) { hasFlippedCard = true; firstCard = this; return; } secondCard = this; checkForMatch(); }
        function checkForMatch() { lockBoard = true; (firstCard.dataset.emoji === secondCard.dataset.emoji) ? disableCards() : unflipCards(); }
        function disableCards() {
            firstCard.classList.add('matched'); secondCard.classList.add('matched');
            matchedPairs++;
            resetBoard();
            if (matchedPairs === cardEmojis.length / 2) {
                const hint = STAGE_DATA[1].puzzles.monitor.hint;
                s1_gameMessage.innerHTML = `ë¯¸ë‹ˆê²Œì„ ì„±ê³µ!<br>ëª¨ë‹ˆí„° í™”ë©´ì— ë¹„ë°€ë²ˆí˜¸ì˜ í•œ ìë¦¬ê°€ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤: <strong style="color:red; font-size:1.5em;">[${hint}]</strong>`;
                markAsSolved('1', 'monitor');
            }
        }
        function unflipCards() { setTimeout(() => { firstCard.classList.remove('flip'); secondCard.classList.remove('flip'); resetBoard(); }, 1000); }
        function resetBoard() { [hasFlippedCard, lockBoard] = [false, false]; [firstCard, secondCard] = [null, null]; }

        document.getElementById('s1-escape-button').addEventListener('click', () => {
            const userInput = document.getElementById('s1-passcode-input').value;
            if (userInput === STAGE_DATA[1].passcode) {
                if (Object.values(STAGE_DATA[1].puzzles).every(p => p.solved)) {
                    alert(`ì •ë‹µì…ë‹ˆë‹¤! 1ë‹¨ê³„ë¥¼ í†µê³¼í–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ 2ë‹¨ê³„ê°€ ì‹œì‘ë©ë‹ˆë‹¤!`);
                    transitionToStage2();
                } else {
                    alert('ì•„ì§ êµì‹¤ì— í’€ì§€ ì•Šì€ ë¬¸ì œê°€ ë‚¨ì•„ìˆëŠ” ê²ƒ ê°™ì•„ìš”!');
                }
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. íŒíŠ¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ì„¸ìš”.');
            }
        });
        
        // --- ìŠ¤í…Œì´ì§€ ì „í™˜ ---
        function transitionToStage2() {
            stage1Container.style.display = 'none';
            stage2Container.style.display = 'block';
        }
        
        // --- 2ë‹¨ê³„ ë¡œì§ ---
        document.getElementById('s2-escape-button').addEventListener('click', () => {
            const userInput = document.getElementById('s2-passcode-input').value;
            if (userInput === STAGE_DATA[2].passcode) {
                if (Object.values(STAGE_DATA[2].puzzles).every(p => p.solved)) {
                    clearInterval(timerInterval);
                    const finalTime = timerDisplay.textContent;
                    alert(`ìµœì¢… íƒˆì¶œ ì„±ê³µ! ì¶•í•˜í•©ë‹ˆë‹¤, ì•ˆì „ ìˆ˜ì¹™ì„ ëª¨ë‘ ë°°ìš°ê³  ë¬´ì‚¬íˆ íƒˆì¶œí–ˆìŠµë‹ˆë‹¤!\n\nì´ ì†Œìš” ì‹œê°„: ${finalTime}\ní•™ìƒ ì •ë³´: ${userInfoInput.value}`);
                    location.reload();
                } else {
                    alert('ì•„ì§ ë³µë„ì— í’€ì§€ ì•Šì€ ë¬¸ì œê°€ ë‚¨ì•„ìˆëŠ” ê²ƒ ê°™ì•„ìš”!');
                }
            } else {
                alert('ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤. íŒíŠ¸ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ì„¸ìš”.');
            }
        });
    });
    </script>
</body>
</html>